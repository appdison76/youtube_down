<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©œë¡œë”” ìŠ¤ëƒ… - ìŒì•… ì°¾ê¸°</title>
    <meta name="description" content="ìŒì•…ì„ ì°¾ê³ , YouTubeì—ì„œ ê²€ìƒ‰í•˜ê³ , ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.">
    <script>
        // ìºì‹œ ë¬´íš¨í™”: CSS/JS ìˆ˜ì • í›„ ì´ ìˆ«ìë§Œ ì˜¬ë¦¬ë©´ ìƒˆë¡œ ë¶ˆëŸ¬ì˜´ (í•œ ê³³ë§Œ ìˆ˜ì •í•˜ë©´ ë¨)
        window.CACHE_V = 5;
    </script>
    <link rel="manifest" href="manifest.json" id="link-manifest">
    <link rel="stylesheet" href="css/styles.css" id="link-css">
    <script>
        (function(){ var v = window.CACHE_V; document.getElementById('link-manifest').href = 'manifest.json?v=' + v; document.getElementById('link-css').href = 'css/styles.css?v=' + v; })();
    </script>
    <script>
        // config ë¡œë“œ ì‹¤íŒ¨ ì‹œ fallback (api.jsì˜ Railway URLê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€)
        window.API_BASE_URL = 'https://youtubedown-production.up.railway.app';
    </script>
</head>
<body>
    <div class="top-bar">
        <!-- PRO ì„¤ì¹˜ ë°°ë„ˆ (íƒ€ì´í‹€ ìœ„) -->
        <a href="/install-page/" id="pro-install-banner" class="pro-install-banner" target="_blank" rel="noopener">
            PRO ë²„ì „ ì„¤ì¹˜
        </a>
        <!-- í—¤ë” -->
        <header class="app-header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo-container">
                    <img id="app-logo" src="logo.png" alt="Melody Snap" onerror="this.style.display='none'" />
                </div>
                <div class="header-title-container">
                    <div class="header-title">Melody Snap</div>
                </div>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-page="recognition">
                    <span class="nav-icon">ğŸµ</span>
                    <span class="nav-text">ìŒì•… ì°¾ê¸°</span>
                </button>
                <button class="nav-tab" data-page="search">
                    <span class="nav-icon">ğŸ”</span>
                    <span class="nav-text">ê²€ìƒ‰</span>
                </button>
                <button class="nav-tab" data-page="save">
                    <span class="nav-icon">ğŸ“¥</span>
                    <span class="nav-text">ë‹¤ìš´ë¡œë“œ</span>
                </button>
                <button class="nav-tab" data-page="library">
                    <span class="nav-icon">â­</span>
                    <span class="nav-text">ì°œí•˜ê¸°</span>
                </button>
            </nav>
        </div>
    </header>
    </div>
    <script>document.getElementById('app-logo').src = 'logo.png?v=' + window.CACHE_V;</script>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="container">
        <!-- ìŒì•… ì°¾ê¸° í™”ë©´ -->
        <div id="recognition-page" class="page active">
            <div class="recognition-area">
                <button id="recognition-btn" class="recognition-button">
                    <ion-icon name="mic" id="mic-icon" class="recognition-icon"></ion-icon>
                    <ion-icon name="stop" id="stop-icon" class="recognition-icon" style="display: none;"></ion-icon>
                </button>
                <p class="recognition-text" id="recognition-status">ìŒì•… ì°¾ê¸°ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>
                <div id="recognition-result" class="recognition-result" style="display: none;">
                    <h3 class="section-title">ì¸ì‹ëœ ê³¡</h3>
                    <div class="result-card recognition-result-card">
                        <img id="result-thumbnail" src="" alt="ì¸ë„¤ì¼" class="result-thumbnail" />
                        <div class="result-info">
                            <h4 id="result-title" class="selectable"></h4>
                            <p id="result-artist" class="selectable"></p>
                            <p id="result-album" class="result-album selectable" style="display: none;"></p>
                        </div>
                    </div>
                    <div id="recognition-youtube-area" class="youtube-results-area" style="display: none;">
                        <h3 class="section-title">ë‹¤ìš´ë¡œë“œí•  ì˜ìƒ ì„ íƒ</h3>
                        <div id="recognition-youtube-results" class="youtube-results-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²€ìƒ‰ í™”ë©´ -->
        <div id="search-page" class="page" style="display: none;">
            <div class="search-area">
                <h3 class="section-title">YouTube ê²€ìƒ‰</h3>
                <input type="text" id="search-input" class="search-input" placeholder="YouTube ê²€ìƒ‰..." />
                <button id="search-btn" class="search-button">ê²€ìƒ‰</button>
                <div id="search-results" class="search-results youtube-results-list"></div>
            </div>
        </div>

        <!-- ë‹¤ìš´ë¡œë“œ í™”ë©´ -->
        <div id="save-page" class="page" style="display: none;">
            <div class="save-area">
                <h3 class="section-title">ì˜ìƒ Â· ìŒì•… ë‹¤ìš´ë¡œë“œ</h3>
                <input type="text" id="url-input" class="url-input" placeholder="YouTube URL ì…ë ¥ ë˜ëŠ” ë¶™ì—¬ë„£ê¸°" />
                <button id="url-submit-btn" class="url-submit-button">ê°€ì ¸ì˜¤ê¸°</button>
                <div id="video-info" class="video-info" style="display: none;">
                    <img id="video-thumbnail" src="" alt="ì¸ë„¤ì¼" />
                    <div class="video-details">
                        <h3 id="video-title"></h3>
                        <p id="video-author"></p>
                        <div class="video-actions">
                            <button id="download-video-btn" class="action-btn">ì˜ìƒ ë‹¤ìš´ë¡œë“œ</button>
                            <button id="download-audio-btn" class="action-btn">ìŒì•… ë‹¤ìš´ë¡œë“œ</button>
                            <button id="favorite-btn" class="action-btn">ì°œí•˜ê¸°</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì°œí•˜ê¸° í™”ë©´ -->
        <div id="library-page" class="page" style="display: none;">
            <div class="library-area">
                <h3 class="section-title">ì°œí•˜ê¸° Â· ë‹¤ìš´ë¡œë“œ ëª©ë¡</h3>
                <div class="library-filters">
                    <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                    <button class="filter-btn" data-filter="favorite">ì°œí•˜ê¸°</button>
                    <button class="filter-btn" data-filter="downloaded">ë‹¤ìš´ë¡œë“œ</button>
                </div>
                <input type="text" id="library-search" class="library-search" placeholder="ê²€ìƒ‰..." />
                <div id="library-items" class="library-items"></div>
            </div>
        </div>
    </main>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        (function(){ var v = window.CACHE_V;
            document.write('<script src="js/indexeddb.js?v='+v+'"><\/script><script src="js/api.js?v='+v+'"><\/script><script src="js/recognition.js?v='+v+'"><\/script><script src="js/search.js?v='+v+'"><\/script><script src="js/save.js?v='+v+'"><\/script><script src="js/library.js?v='+v+'"><\/script><script src="js/app.js?v='+v+'"><\/script>');
        })();
    </script>
    <script>
        // ë¸Œë¼ìš°ì € ì„¤ì • ì•ˆë‚´ (ì§ì ‘ ì—´ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ëª…í™•í•œ ì•ˆë‚´ ì œê³µ)
        function openBrowserSettings() {
            const userAgent = navigator.userAgent.toLowerCase();
            let message = '';
            
            if (userAgent.includes('android')) {
                // Android ë¸Œë¼ìš°ì € (ìµœì‹  ë²„ì „ ëŒ€ì‘)
                message = 'ğŸ“± Android ë¸Œë¼ìš°ì € ë§ˆì´í¬ ê¶Œí•œ ì„¤ì •:\n\n' +
                         'ë°©ë²• 1 (ê°€ì¥ ì‰¬ì›€):\n' +
                         'â†’ ë¸Œë¼ìš°ì € ë©”ë‰´(â‹®) í´ë¦­ (í™”ë©´ ì˜¤ë¥¸ìª½ ìƒë‹¨)\n' +
                         'â†’ "ì‚¬ì´íŠ¸ ì„¤ì •" ë˜ëŠ” "ê¶Œí•œ" ì°¾ê¸°\n' +
                         'â†’ "ë§ˆì´í¬" â†’ "í—ˆìš©"ìœ¼ë¡œ ë³€ê²½\n\n' +
                         'ë°©ë²• 2:\n' +
                         'â†’ ë¸Œë¼ìš°ì € ë©”ë‰´(â‹®) â†’ ì„¤ì •\n' +
                         'â†’ "ì‚¬ì´íŠ¸ ì„¤ì •" â†’ "ë§ˆì´í¬"\n' +
                         'â†’ ì´ ì‚¬ì´íŠ¸ë¥¼ ì°¾ì•„ "í—ˆìš©"ìœ¼ë¡œ ë³€ê²½\n\n' +
                         'ë°©ë²• 3:\n' +
                         'â†’ ì£¼ì†Œì°½ì˜ ì•„ì´ì½˜ì´ ë³´ì´ë©´ í´ë¦­\n' +
                         'â†’ "ì‚¬ì´íŠ¸ ì„¤ì •" â†’ "ë§ˆì´í¬" â†’ "í—ˆìš©"\n\n' +
                         'ğŸ’¡ ë¸Œë¼ìš°ì € ë²„ì „ì— ë”°ë¼ ë©”ë‰´ ìœ„ì¹˜ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            } else if (userAgent.includes('iphone') || userAgent.includes('ipad')) {
                // iOS Safari
                message = 'ğŸ“± iOS Safari ë§ˆì´í¬ ê¶Œí•œ ì„¤ì •:\n\n' +
                         'ë°©ë²• 1 (ê°€ì¥ ì‰¬ì›€):\n' +
                         'â†’ ì£¼ì†Œì°½ ì™¼ìª½ì˜ "aA" ì•„ì´ì½˜ í´ë¦­\n' +
                         'â†’ "ì‚¬ì´íŠ¸ ì„¤ì •" ë˜ëŠ” "ì›¹ì‚¬ì´íŠ¸ ì„¤ì •"\n' +
                         'â†’ "ë§ˆì´í¬" â†’ "í—ˆìš©"ìœ¼ë¡œ ë³€ê²½\n\n' +
                         'ë°©ë²• 2:\n' +
                         'â†’ ì„¤ì • ì•± â†’ Safari\n' +
                         'â†’ "ì¹´ë©”ë¼" ë˜ëŠ” "ë§ˆì´í¬" í—ˆìš© í™•ì¸\n\n' +
                         'ë°©ë²• 3:\n' +
                         'â†’ Safariì—ì„œ ì£¼ì†Œì°½ì˜ ìë¬¼ì‡  ì•„ì´ì½˜ í´ë¦­\n' +
                         'â†’ "ì›¹ì‚¬ì´íŠ¸ ì„¤ì •" â†’ "ë§ˆì´í¬" í—ˆìš©';
            } else {
                // Desktop (ìµœì‹  ë¸Œë¼ìš°ì € ëŒ€ì‘)
                message = 'ğŸ’» ë°ìŠ¤í¬í†± ë¸Œë¼ìš°ì € ë§ˆì´í¬ ê¶Œí•œ ì„¤ì •:\n\n' +
                         'ë°©ë²• 1 (ê°€ì¥ ì‰¬ì›€):\n' +
                         'â†’ ë¸Œë¼ìš°ì € ë©”ë‰´(â‹®) í´ë¦­ (í™”ë©´ ì˜¤ë¥¸ìª½ ìƒë‹¨)\n' +
                         'â†’ "ì„¤ì •" â†’ "ê°œì¸ì •ë³´ ë° ë³´ì•ˆ" â†’ "ì‚¬ì´íŠ¸ ì„¤ì •"\n' +
                         'â†’ "ë§ˆì´í¬" â†’ ì´ ì‚¬ì´íŠ¸ë¥¼ í—ˆìš© ëª©ë¡ì— ì¶”ê°€\n\n' +
                         'ë°©ë²• 2:\n' +
                         'â†’ ì£¼ì†Œì°½ì˜ ì•„ì´ì½˜ì´ ë³´ì´ë©´ í´ë¦­\n' +
                         'â†’ "ì‚¬ì´íŠ¸ ì„¤ì •" ë˜ëŠ” "ê¶Œí•œ" â†’ "ë§ˆì´í¬" â†’ "í—ˆìš©"\n\n' +
                         'ë°©ë²• 3 (Chrome/Edge):\n' +
                         'â†’ ì£¼ì†Œì°½ì— ì…ë ¥: chrome://settings/content/microphone\n' +
                         'â†’ ì´ ì‚¬ì´íŠ¸ë¥¼ í—ˆìš© ëª©ë¡ì— ì¶”ê°€\n\n' +
                         'ë°©ë²• 4 (Firefox):\n' +
                         'â†’ ë¸Œë¼ìš°ì € ë©”ë‰´(â˜°) â†’ ì„¤ì •\n' +
                         'â†’ "ê°œì¸ ì •ë³´ ë° ë³´ì•ˆ" â†’ "ê¶Œí•œ" â†’ "ë§ˆì´í¬"\n\n' +
                         'ğŸ’¡ ë¸Œë¼ìš°ì € ë²„ì „ì— ë”°ë¼ ë©”ë‰´ êµ¬ì¡°ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            }
            
            // ëª¨ë‹¬ ìŠ¤íƒ€ì¼ì˜ ì•ˆë‚´ í‘œì‹œ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 20px;
            `;
            
            const content = document.createElement('div');
            content.style.cssText = `
                background: white;
                padding: 24px;
                border-radius: 12px;
                max-width: 400px;
                width: 100%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            `;
            
            const text = document.createElement('div');
            text.style.cssText = `
                white-space: pre-line;
                line-height: 1.6;
                color: #333;
                font-size: 14px;
                margin-bottom: 16px;
            `;
            text.textContent = message;
            
            const closeBtn = document.createElement('button');
            closeBtn.textContent = 'ë‹«ê¸°';
            closeBtn.style.cssText = `
                width: 100%;
                padding: 12px;
                background: #FF0000;
                color: white;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                cursor: pointer;
                font-weight: bold;
            `;
            closeBtn.onclick = () => {
                document.body.removeChild(modal);
            };
            
            content.appendChild(text);
            content.appendChild(closeBtn);
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.onclick = (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            };
        }
    </script>
</body>
</html>
