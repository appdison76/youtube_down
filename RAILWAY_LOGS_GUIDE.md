# Railway ë¡œê·¸ í™•ì¸ ê°€ì´ë“œ

## ðŸ“‹ Railway ë¡œê·¸ ë³´ëŠ” ë°©ë²•

### 1. Railway ì›¹ ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸

1. **Railway ì›¹ì‚¬ì´íŠ¸ ì ‘ì†**
   - https://railway.app ì ‘ì†
   - ë¡œê·¸ì¸

2. **í”„ë¡œì íŠ¸ ì„ íƒ**
   - ëŒ€ì‹œë³´ë“œì—ì„œ `youtubedown-production` í”„ë¡œì íŠ¸ í´ë¦­

3. **ì„œë¹„ìŠ¤(Service) ì„ íƒ**
   - í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì„œë²„ ì„œë¹„ìŠ¤ í´ë¦­

4. **ë¡œê·¸ í™•ì¸**
   - ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **"Logs"** íƒ­ í´ë¦­
   - ë˜ëŠ” ì„œë¹„ìŠ¤ íŽ˜ì´ì§€ì—ì„œ **"View Logs"** ë²„íŠ¼ í´ë¦­
   - ì‹¤ì‹œê°„ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤

### 2. Railway CLIë¡œ í™•ì¸ (ì„ íƒì‚¬í•­)

```bash
# Railway CLI ì„¤ì¹˜ (ì—†ëŠ” ê²½ìš°)
npm i -g @railway/cli

# ë¡œê·¸ì¸
railway login

# í”„ë¡œì íŠ¸ ì—°ê²°
railway link

# ë¡œê·¸ ë³´ê¸°
railway logs

# ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
railway logs --follow
```

### 3. ë¡œê·¸ì—ì„œ í™•ì¸í•  ë‚´ìš©

**ì •ìƒ ìž‘ë™ ì‹œ:**
- ì„œë²„ ì‹œìž‘ ë©”ì‹œì§€: `Server is running on port ...`
- API ìš”ì²­ ë¡œê·¸: `GET /api/video-info`, `GET /api/download/audio` ë“±
- yt-dlp ë‹¤ìš´ë¡œë“œ ì§„í–‰ ìƒí™©

**ì˜¤ë¥˜ ë°œìƒ ì‹œ:**
- ì—°ê²° ì˜¤ë¥˜: `ECONNREFUSED`, `ETIMEDOUT` ë“±
- Python/yt-dlp ì˜¤ë¥˜: `yt-dlp` ê´€ë ¨ ì—ëŸ¬ ë©”ì‹œì§€
- í¬íŠ¸ ì˜¤ë¥˜: `EADDRINUSE` ë“±

### 4. ë¡œê·¸ í•„í„°ë§

Railway ë¡œê·¸ í™”ë©´ì—ì„œ:
- íŠ¹ì • í‚¤ì›Œë“œ ê²€ìƒ‰ ê°€ëŠ¥
- ë¡œê·¸ ë ˆë²¨ë³„ í•„í„°ë§ (ERROR, WARN, INFO)
- ì‹œê°„ ë²”ìœ„ ì„ íƒ ê°€ëŠ¥

## ðŸ” ë¬¸ì œ í•´ê²° íŒ

1. **ì„œë²„ê°€ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ê²½ìš°:**
   - ë¡œê·¸ì—ì„œ ì„œë²„ ì‹œìž‘ ë©”ì‹œì§€ í™•ì¸
   - í¬íŠ¸ ì„¤ì • í™•ì¸ (`process.env.PORT` ì‚¬ìš© í™•ì¸)

2. **yt-dlp ì˜¤ë¥˜:**
   - Python ë²„ì „ í™•ì¸
   - yt-dlp ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸
   - ë¡œê·¸ì—ì„œ ìƒì„¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

3. **ì—°ê²° íƒ€ìž„ì•„ì›ƒ:**
   - Railway ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
   - ë°©í™”ë²½/ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸

## ðŸ“ ìš”ì²­ ë¡œê·¸ (ë¦¬ìŠ¤íƒ€íŠ¸ í›„ì—ë„ í™•ì¸)

Railway ì½˜ì†” ë¡œê·¸ëŠ” **ë¦¬ìŠ¤íƒ€íŠ¸í•˜ë©´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.**  
ë‹¤ìš´ë¡œë“œ/ê²€ìƒ‰ ë“± **ì‹¤ì œ ì‚¬ìš© ìš”ì²­**ì€ ë³„ë„ë¡œ ê¸°ë¡í•´ ë‘ê³ , **ìž¬ì‹œìž‘ í›„ì—ë„** ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### 1. ë©”ëª¨ë¦¬ ë¡œê·¸ (ê¸°ë³¸)

- **ìµœê·¼ 500ê±´**ë§Œ ë©”ëª¨ë¦¬ì— ìœ ì§€
- ë¦¬ìŠ¤íƒ€íŠ¸í•˜ë©´ **ì´ˆê¸°í™”ë¨**

### 2. íŒŒì¼ ë¡œê·¸ (ë¦¬ìŠ¤íƒ€íŠ¸ í›„ì—ë„ ìœ ì§€)

- **`LOG_DIR`** í™˜ê²½ ë³€ìˆ˜ì— ê²½ë¡œë¥¼ ë„£ìœ¼ë©´, í•´ë‹¹ ê²½ë¡œì— `requests.log` ì €ìž¥
- Railway **Volume**ì„ ì“°ë©´ ìž¬ì‹œìž‘/ìž¬ë°°í¬ í›„ì—ë„ ìœ ì§€
- **ìš©ëŸ‰ ìžë™ ê´€ë¦¬**: íŒŒì¼ì´ **10MB** ë„˜ìœ¼ë©´ ì˜¤ëž˜ëœ ë¡œê·¸ ìžë™ ì‚­ì œ (ìµœê·¼ 50%ë§Œ ìœ ì§€)
  - `MAX_LOG_SIZE_MB` í™˜ê²½ ë³€ìˆ˜ë¡œ ë³€ê²½ ê°€ëŠ¥ (ì˜ˆ: `MAX_LOG_SIZE_MB=20` â†’ 20MB)

**Railway Volume ì„¤ì • ì˜ˆ:**

1. Railway í”„ë¡œì íŠ¸ â†’ ì„œë¹„ìŠ¤ â†’ **Volumes** ì¶”ê°€
2. ë§ˆìš´íŠ¸ ê²½ë¡œ ì˜ˆ: `/data`
3. ì„œë¹„ìŠ¤ **Variables**ì— ì¶”ê°€:
   - `LOG_DIR=/data`
   - (ì„ íƒ) `MAX_LOG_SIZE_MB=20` (ê¸°ë³¸ 10MB)
4. ìž¬ë°°í¬ í›„ `[Server] ìš”ì²­ ë¡œê·¸ íŒŒì¼ ì €ìž¥: /data/requests.log (ë¦¬ìŠ¤íƒ€íŠ¸ í›„ì—ë„ ìœ ì§€, ìµœëŒ€ 10MB)` ë¡œê·¸ í™•ì¸

### 3. ì¡°íšŒ ë°©ë²•

#### ë°©ë²• 1: ì›¹ UI (ê¶Œìž¥) ðŸŒ

**ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†:**
```
https://youtubedown-production.up.railway.app/admin/logs
```

- ê´€ë¦¬ìž í‚¤ ìž…ë ¥
- ë¡œê·¸ ì†ŒìŠ¤ ì„ íƒ (ë©”ëª¨ë¦¬/íŒŒì¼)
- ë‚ ì§œ ë²”ìœ„ ì„ íƒ (ì˜µì…˜)
- ì¡°íšŒ ë²„íŠ¼ í´ë¦­

**ê¸°ëŠ¥:**
- âœ… ì§ê´€ì ì¸ ì›¹ ì¸í„°íŽ˜ì´ìŠ¤
- âœ… ë‚ ì§œ ë²”ìœ„ í•„í„°ë§
- âœ… í…Œì´ë¸” í˜•íƒœë¡œ ê²°ê³¼ í‘œì‹œ
- âœ… IP, ì‹œê°„, ê²½ë¡œ, URL í™•ì¸

#### ë°©ë²• 2: API ì§ì ‘ í˜¸ì¶œ

**`GET /api/admin/requests`**

- **í•„ìˆ˜:** `ADMIN_SECRET` í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- **ì¿¼ë¦¬:** `?key=ADMIN_SECRETê°’`  
  - `&limit=100` (ê¸°ë³¸ 100, ìµœëŒ€ 500)  
  - `&fromFile=1` â†’ **íŒŒì¼ ë¡œê·¸**ì—ì„œ ì¡°íšŒ (ë¦¬ìŠ¤íƒ€íŠ¸ í›„ í™•ì¸ìš©)
  - `&fromDate=2026-01-28T00:00:00Z` â†’ ì‹œìž‘ ë‚ ì§œ (ISO 8601)
  - `&toDate=2026-01-28T23:59:59Z` â†’ ì¢…ë£Œ ë‚ ì§œ (ISO 8601)

**API í˜¸ì¶œ ì˜ˆì‹œ:**

```bash
# ë©”ëª¨ë¦¬ ë¡œê·¸ (ìµœê·¼ 100ê±´)
curl "https://youtubedown-production.up.railway.app/api/admin/requests?key=ë‚´ë¹„ë°€í‚¤&limit=100"

# íŒŒì¼ ë¡œê·¸ (ìµœê·¼ 200ê±´)
curl "https://youtubedown-production.up.railway.app/api/admin/requests?key=ë‚´ë¹„ë°€í‚¤&fromFile=1&limit=200"

# íŠ¹ì • ë‚ ì§œ ë²”ìœ„ (ì˜›ë‚  ë¡œê·¸ ì¡°íšŒ)
curl "https://youtubedown-production.up.railway.app/api/admin/requests?key=ë‚´ë¹„ë°€í‚¤&fromFile=1&fromDate=2026-01-27T00:00:00Z&toDate=2026-01-27T23:59:59Z&limit=500"
```

**ì‘ë‹µ ì˜ˆ:**

```json
{
  "count": 10,
  "source": "memory",
  "logFile": "/data/requests.log",
  "requests": [
    { "at": "2026-01-28T12:00:00.000Z", "ip": "1.2.3.4", "method": "GET", "path": "/api/download/audio", "url": "https://youtube.com/..." }
  ]
}
```

- **`source`**: `memory`(ìž¬ì‹œìž‘ í›„ ì´ˆê¸°í™”) / `file`(íŒŒì¼ì—ì„œ ì½ìŒ, ìž¬ì‹œìž‘ í›„ì—ë„ ìœ ì§€)
- **`ip`**: ìš”ì²­ í´ë¼ì´ì–¸íŠ¸ IP (ë³¸ì¸ ì œì™¸í•œ ì‚¬ìš©ìž í™•ì¸ìš©)

### 4. ì •ë¦¬

| êµ¬ë¶„ | ë¦¬ìŠ¤íƒ€íŠ¸ í›„ |
|------|-------------|
| Railway ì½˜ì†” ë¡œê·¸ | âŒ ì‚¬ë¼ì§ |
| ë©”ëª¨ë¦¬ ìš”ì²­ ë¡œê·¸ (`/api/admin/requests`) | âŒ ì‚¬ë¼ì§ |
| íŒŒì¼ ìš”ì²­ ë¡œê·¸ (`LOG_DIR` + `fromFile=1`) | âœ… ìœ ì§€ (Volume ì‚¬ìš© ì‹œ) |

---

## ðŸ“ í˜„ìž¬ ì„œë²„ ì •ë³´

- **Railway URL**: `https://youtubedown-production.up.railway.app`
- **ì„œë²„ ìœ„ì¹˜**: Railway í´ë¼ìš°ë“œ
- **ë¡œê·¸ ìœ„ì¹˜**: Railway ëŒ€ì‹œë³´ë“œ > í”„ë¡œì íŠ¸ > ì„œë¹„ìŠ¤ > Logs









